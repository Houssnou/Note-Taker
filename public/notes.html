<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
  <link rel="stylesheet" href="style.css">
  <title>Home|Note Taker</title>
</head>

<body>
  <!-- nav bar  -->
  <nav class="navbar navbar-expand-lg navbar-light bg-primary">
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="./">Note Taker <span class="sr-only">(current)</span></a>
        </li>

      </ul>
      <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="coming soon" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search </button>
      </form>
    </div>
  </nav>
  <!-- end nav bar -->
  <!-- jumbotron for the accordion-->
  <div class="container my-4">
    <!-- New Note Form -->
    <div class="card mb-4 border-dark">
      <div class="card-header bg-dark text-light">
        What do you have in mind
      </div>
      <div class="card-body border-dark">
        <form role="form">
          <div class="form-group">
            <input type="text" class="form-control" id="title-input" placeholder="Note Title">
          </div>

          <div class="form-group">
            <textarea class="form-control" id="content-input" rows="2" placeholder="Save what your mind"></textarea>
          </div>
          <div class="form-group text-right">
            <button class="btn btn-outline-primary btn-sm" id="add-note" type="submit">Save</button>
            <button class="btn btn-outline-secondary btn-sm" id="reset-note" type="reset">Reset</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Accordion -->
    <div class="accordion" id="accordion">
      <!-- <div class="card">
        <div class="card-header" id="headingOne">
          <h5 class="mb-0">
            <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#note1" aria-expanded="true"
              aria-controls="note1">
              Note 1
            </button>
            | Created: xxxx-xx-xx 00:00:00 Last modification: xxxx-xx-xx 00:00:00
            <i class="fas fa-edit"></i>
            <i class="fas fa-trash-alt"></i>
          </h5>
        </div>

        <div id="note1" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
          <div class="card-body">
            Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon
            officia aute, non cupidatat skateboard dolor brunch. 
          </div>
        </div>
      </div> -->
      
      
    </div>

  </div>
  <!-- end jumbotron -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.13.0/umd/popper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/moment.min.js"></script>
</body>
<script type="text/javascript">
// on load display all notes from db
//build the content of our accordion 
//ajax call 
// call the API tables
$.ajax({
        url: "/api/notes",
        method: "GET"
      })
      .then(function (notes) {
        console.log(notes);
        notes.forEach((note,index) => {
        //accordion is just a card with header and body so lets have fun.
        
        //build the card
        const $card=$("<card>");

        //the header
        const $cardheader=$(`<div class='card-header' id='heading${index+1}'>`);

        //h5 tag to wrap the title and the other data
        //const $h5=$("<h5 class='mb-0'>").appendTo($cardheader);
        //inline style to be removed later #collapse-link {color: black; font-weight: bold; text-decoration: none;
        //button to make the title clikable
        const $buttonTitle=$(`<button class='btn btn-link' type='button' 
                              data-toggle='collapse' data-target='#note${index+1}'
                              aria-expanded='false' aria-controls='note${index+1}'
                              style='color: black; font-weight: bold; text-decoration: none'>`).text(note.title);

        //build the line //build the line: Note 1 created: modified edit and suppress icon 
        const $spanCreated=$("<span>").text(`Created :${note.date_creation} `);
        const $spanModified=$("<span>").text(`- Last Access: ${note.last_modification}`); 
        const $update=$("<i class='fas fa-edit'>");
        const $delete=$("<i class='fas fa-trash-alt'>");
        //append them to the h5 tag
        $cardheader.append($buttonTitle,$spanCreated,$spanModified,$update,$delete);        
       // $cardheader.text(note.title);

        //the body
        //quik
        const $divCollapse=$(`<div id='note${index+1}' aria-labelledby='heading${index+1}' data-parent='#accordion'>`);
        //quick check to determine if it should be a class collapse show or not
        
        (index===0)? $divCollapse.addClass("collapse show"): $divCollapse.addClass("collapse"); 
        
        
        const $cardBody=$("<div class='card-body'>");
              $cardBody.text(note.content).appendTo($divCollapse);
        
        //build the card content
        $card.append($cardheader, $divCollapse).appendTo("#accordion");


          
        });
      });

</script>

</html>